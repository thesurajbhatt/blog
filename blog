//server.js

const express=require('express')
const mongoose=require('mongoose')
const app=express()
const routesStud=require('./routes/student_route')
const cors=require('cors')

mongoose.connect('mongodb://localhost:27017/student')
app.use(express.json)
app.use(cors())
app.use('/student',routesStud)

app.listen(5000,()=>{
    console.log('server started')
})

//student_models

const mongoose=require('mongoose')
const singup=new mongoose.Schema({
    name:{
        type:String,
        required:true,
    },

    email:{
        type:String,
        required:true,
    },

    phone:{
        type:String,
        required:true,
    },

    username:{
        type:String,
        required:true,
    },

    password:{
        type:String,
        required:true,
    },

    sign_date:{
        type:String,
        default:Date.now
    }
})
module.exports=mongoose.model('student_master',singup)

//student_routes.js


const express=require('express')
const router=express.Router()
const signupinfo=require('../models/student_models')


//Insert
router.post('/signup',async (req,res)=>{
    const signupentry=new signupinfo({
        name:req.body.name,
        email:req.body.email,
        phone:req.body.phone,
        username:req.body.username,
        password:req.body.password,
    })
    signupentry.save()
})


//Display 
router.get('/dispStudent',async(req,res)=>{
    const data= await signupinfo.find()
    res.json(data)
})

module.exports=router


//test.rest

const express=require('express')
const router=express.Router()
const signupinfo=require('../models/student_models')


//Insert
router.post('/signup',async (req,res)=>{
    const signupentry=new signupinfo({
        name:req.body.name,
        email:req.body.email,
        phone:req.body.phone,
        username:req.body.username,
        password:req.body.password,
    })
    signupentry.save()
})


//Display 
router.get('/dispStudent',async(req,res)=>{
    const data= await signupinfo.find()
    res.json(data)
})

module.exports=router
